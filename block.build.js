this.pluginnamespace=this.pluginnamespace||{},this.pluginnamespace.main=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r)&&r.length){var a=o.apply(null,r);a&&e.push(a)}else if("object"===i)for(var l in r)n.call(r,l)&&r[l]&&e.push(l)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var u=wp.element,p=u.Component,m=u.Fragment,d=wp.components,f=d.IconButton,g=d.Spinner,b=wp.i18n,y=b.__,h=(b.setLocaleData,wp.keycodes),v=h.BACKSPACE,w=h.DELETE,S=wp.data.withSelect,k=wp.editor.RichText,E=wp.blob.isBlobURL,C=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(r=l(t).apply(this,arguments))||"object"!==i(r)&&"function"!=typeof r?s(n):r).onImageClick=e.onImageClick.bind(s(s(e))),e.onSelectCaption=e.onSelectCaption.bind(s(s(e))),e.onKeyDown=e.onKeyDown.bind(s(s(e))),e.bindContainer=e.bindContainer.bind(s(s(e))),e.state={captionSelected:!1},e}var n,r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,p),n=t,(r=[{key:"bindContainer",value:function(e){this.container=e}},{key:"onSelectCaption",value:function(){this.state.captionSelected||this.setState({captionSelected:!0}),this.props.isSelected||this.props.onSelect()}},{key:"onImageClick",value:function(){this.props.isSelected||this.props.onSelect(),this.state.captionSelected&&this.setState({captionSelected:!1})}},{key:"onKeyDown",value:function(e){this.container===document.activeElement&&this.props.isSelected&&-1!==[v,w].indexOf(e.keyCode)&&(e.stopPropagation(),e.preventDefault(),this.props.onRemove())}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isSelected,r=t.image,o=t.url;r&&!o&&this.props.setAttributes({url:r.source_url,alt:r.alt_text}),this.state.captionSelected&&!n&&e.isSelected&&this.setState({captionSelected:!1})}},{key:"render",value:function(){var e,t=this.props,n=t.url,r=t.alt,i=t.id,a=t.linkTo,l=t.link,c=t.isSelected,s=t.caption,u=t.onRemove,p=t.setAttributes,d=t["aria-label"];switch(a){case"media":e=n;break;case"attachment":e=l}var b=wp.element.createElement(m,null,wp.element.createElement("img",{src:n,alt:r,"data-id":i,onClick:this.onImageClick,tabIndex:"0",onKeyDown:this.onImageClick,"aria-label":d}),E(n)&&wp.element.createElement(g,null)),h=o()({"is-selected":c,"is-transient":E(n)});return wp.element.createElement("figure",{className:h,tabIndex:"-1",onKeyDown:this.onKeyDown,ref:this.bindContainer},c&&wp.element.createElement("div",{className:"block-library-gallery-item__inline-menu"},wp.element.createElement(f,{icon:"no-alt",onClick:u,className:"blocks-gallery-item__remove",label:y("Remove Image")})),e?wp.element.createElement("a",{href:e},b):b,!k.isEmpty(s)||c?wp.element.createElement(k,{tagName:"figcaption",placeholder:y("Write captionâ€¦"),value:s,isSelected:this.state.captionSelected,onChange:function(e){return p({caption:e})},unstableOnFocus:this.onSelectCaption,inlineToolbar:!0}):null)}}])&&a(n.prototype,r),u&&a(n,u),t}(),I=S(function(e,t){var n=e("core").getMedia,r=t.id;return{image:r?n(r):null}})(C);n(2);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){T(e,t,n[t])})}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var N=lodash,D=N.filter,R=N.pick,L=N.get,M=wp.element,B=M.Component,z=M.Fragment,U=wp.i18n,K=U.__,H=U.sprintf,V=(U.setLocaleData,wp.components),q=V.IconButton,G=V.DropZone,J=V.FormFileUpload,$=V.PanelBody,W=(V.RangeControl,V.TextControl),Z=V.SelectControl,Q=V.ToggleControl,X=V.Toolbar,Y=V.withNotices,ee=wp.editor,te=ee.BlockControls,ne=ee.MediaUpload,re=ee.MediaPlaceholder,oe=ee.InspectorControls,ie=ee.mediaUpload,ae=[{value:"fade",label:K("Fade","gutenberg-slider")},{value:"scroll",label:K("Scroll","gutenberg-slider")}],le=[{value:"attachment",label:K("Attachment Page")},{value:"media",label:K("Media File")},{value:"none",label:K("None")}],ce=["image"],se=function(e){var t=R(e,["alt","id","link","caption"]);return t.url=L(e,["sizes","large","url"])||L(e,["media_details","sizes","large","source_url"])||e.url,t},ue=Y(function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(r=P(t).apply(this,arguments))||"object"!==O(r)&&"function"!=typeof r?x(n):r).getAvailableSizes=e.getAvailableSizes.bind(x(x(e))),e.onSelectImage=e.onSelectImage.bind(x(x(e))),e.onSelectImages=e.onSelectImages.bind(x(x(e))),e.setLinkTo=e.setLinkTo.bind(x(x(e))),e.setSpeed=e.setSpeed.bind(x(x(e))),e.setEffect=e.setEffect.bind(x(x(e))),e.toggleAutoplay=e.toggleAutoplay.bind(x(x(e))),e.toggleImageCrop=e.toggleImageCrop.bind(x(x(e))),e.onRemoveImage=e.onRemoveImage.bind(x(x(e))),e.setImageAttributes=e.setImageAttributes.bind(x(x(e))),e.addFiles=e.addFiles.bind(x(x(e))),e.uploadFromFiles=e.uploadFromFiles.bind(x(x(e))),e.setAttributes=e.setAttributes.bind(x(x(e))),e.state={selectedImage:null},e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,B),n=t,(r=[{key:"getAvailableSizes",value:function(){return L(this.props.image,["media_details","sizes"],{})}},{key:"setAttributes",value:function(e){if(e.ids)throw new Error('The "ids" attribute should not be changed directly. It is managed automatically when "images" attribute changes');e.images&&(e=A({},e,{ids:map(e.images,"id")})),this.props.setAttributes(e)}},{key:"onSelectImage",value:function(e){var t=this;return function(){t.state.selectedImage!==e&&t.setState({selectedImage:e})}}},{key:"onRemoveImage",value:function(e){var t=this;return function(){var n=D(t.props.attributes.images,function(t,n){return e!==n});t.setState({selectedImage:null}),t.setAttributes({images:n})}}},{key:"onSelectImages",value:function(e){console.log(JSON.stringify(e)),this.props.setAttributes({images:e.map(function(e){return se(e)})})}},{key:"setLinkTo",value:function(e){this.setAttributes({linkTo:e})}},{key:"setSpeed",value:function(e){this.setAttributes({speed:e})}},{key:"setEffect",value:function(e){this.setAttributes({effect:e})}},{key:"toggleAutoplay",value:function(){this.setAttributes({autoplay:!this.props.attributes.autoplay})}},{key:"toggleImageCrop",value:function(){this.setAttributes({imageCrop:!this.props.attributes.imageCrop})}},{key:"getImageCropHelp",value:function(e){return K(e?"Thumbnails are cropped to align.":"Thumbnails are not cropped.")}},{key:"setImageAttributes",value:function(e,t){var n=this.props.attributes.images,r=this.setAttributes;n[e]&&r({images:[].concat(_(n.slice(0,e)),[A({},n[e],t)],_(n.slice(e+1)))})}},{key:"uploadFromFiles",value:function(e){this.addFiles(e.target.files)}},{key:"addFiles",value:function(e){var t=this.props.attributes.images||[],n=this.props.noticeOperations,r=this.setAttributes;ie({allowedTypes:ce,filesList:e,onFileChange:function(e){var n=e.map(function(e){return se(e)});r({images:t.concat(n)})},onError:n.createErrorNotice})}},{key:"componentDidUpdate",value:function(e){!this.props.isSelected&&e.isSelected&&this.setState({selectedImage:null,captionSelected:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.attributes,r=t.isSelected,o=t.className,i=t.noticeOperations,a=t.noticeUI,l=n.images,c=n.imageCrop,s=n.autoplay,u=n.speed,p=n.effect,m=n.linkTo,d=wp.element.createElement(G,{onFilesDrop:this.addFiles}),f=wp.element.createElement(te,null,!!l.length&&wp.element.createElement(X,null,wp.element.createElement(ne,{onSelect:this.onSelectImages,allowedTypes:ce,multiple:!0,gallery:!0,value:l.map(function(e){return e.id}),render:function(e){var t=e.open;return wp.element.createElement(q,{className:"components-toolbar__control",label:K("Edit Slider","gutenberg-slider"),icon:"edit",onClick:t})}})));return 0===l.length?wp.element.createElement(z,null,f,wp.element.createElement(re,{icon:"format-gallery",className:o,labels:{title:K("Slider","gutenberg-slider"),instructions:K("Drag images, upload new ones or select files from your library.","gutenberg-slider")},onSelect:this.onSelectImages,accept:"image/*",allowedTypes:ce,multiple:!0,notices:a,onError:i.createErrorNotice})):(console.log(JSON.stringify(l)),wp.element.createElement(z,null,f,wp.element.createElement(oe,null,wp.element.createElement($,{title:K("Slider Settings","gutenberg-slider")},wp.element.createElement(Q,{label:K("Crop Images"),checked:!!c,onChange:this.toggleImageCrop,help:this.getImageCropHelp}),wp.element.createElement(Q,{label:K("Autoplay","gutenberg-slider"),checked:!!s,onChange:this.toggleAutoplay}),wp.element.createElement(W,{label:K("Speed","gutenberg-slider"),type:"number",min:"100",max:"500",value:u,onChange:this.setSpeed}),wp.element.createElement(Z,{label:K("Effect","gutenberg-slider"),value:p,onChange:this.setEffect,options:ae}),wp.element.createElement(Z,{label:K("Link To"),value:m,onChange:this.setLinkTo,options:le}))),a,wp.element.createElement("ul",{className:"".concat(o," ").concat(c?"is-cropped":"")},d,l.map(function(t,n){var o=K(H("image %1$d of %2$d in slider",n+1,l.length));return wp.element.createElement("li",{className:"blocks-gallery-item",key:t.id||t.url},wp.element.createElement(I,{url:t.url,alt:t.alt,id:t.id,isSelected:r&&e.state.selectedImage===n,onRemove:e.onRemoveImage(n),onSelect:e.onSelectImage(n),setAttributes:function(t){return e.setImageAttributes(n,t)},caption:t.caption,"aria-label":o}))}),r&&wp.element.createElement("li",{className:"blocks-gallery-item has-add-item-button"},wp.element.createElement(J,{multiple:!0,isLarge:!0,className:"block-library-gallery-add-item-button",onChange:this.uploadFromFiles,accept:"image/*",icon:"insert"},K("Upload an image"))))))}}])&&j(n.prototype,r),o&&j(n,o),t}());n(3);n.d(t,"name",function(){return _e}),n.d(t,"settings",function(){return Te});var pe=lodash,me=pe.filter,de=pe.every,fe=pe.map,ge=(pe.some,wp.i18n),be=ge.__,ye=(ge.setLocaleData,wp.blocks),he=ye.createBlock,ve=ye.registerBlockType,we=wp.editor,Se=we.RichText,ke=we.mediaUpload,Ee=wp.blob.createBlobURL,Ce=wp.components,Ie=(Ce.G,Ce.Path),Oe=Ce.SVG,_e="occ/slider",Ae=function(e){return e?e.split(",").map(function(e){return parseInt(e,10)}):[]},Te={title:be("Slider","gutenberg-slider"),description:be("Display multiple images in an elegant slider.","gutenberg-slider"),icon:wp.element.createElement(Oe,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},wp.element.createElement(Ie,{fill:"none",d:"M0 0h24v24H0z"}),wp.element.createElement(Ie,{d:"M10 8v8l5-4-5-4zm9-5H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"})),category:"common",keywords:[be("images"),be("photos")],attributes:{images:{type:"array",default:[],source:"query",selector:"ul.wp-block-occ-slider .blocks-gallery-item",query:{url:{source:"attribute",selector:"img",attribute:"src"},link:{source:"attribute",selector:"img",attribute:"data-link"},alt:{source:"attribute",selector:"img",attribute:"alt",default:""},id:{source:"attribute",selector:"img",attribute:"data-id"},caption:{type:"string",source:"html",selector:"figcaption"}}},ids:{type:"array",default:[]},imageCrop:{type:"boolean",default:!0},autoplay:{type:"boolean",default:!0},speed:{type:"string",default:"300"},effect:{type:"string",default:"fade"},linkTo:{type:"string",default:"none"}},transforms:{from:[{type:"block",isMultiBlock:!0,blocks:["core/image"],transform:function(e){var t=me(e,function(e){var t=e.id,n=e.url;return t&&n});return t.length>0?he("occ/slider",{images:t.map(function(e){return{id:e.id,url:e.url,alt:e.alt,caption:e.caption}}),ids:t.map(function(e){return e.id})}):he("occ/slider")}},{type:"shortcode",tag:"gallery",attributes:{images:{type:"array",shortcode:function(e){var t=e.named.ids;return Ae(t).map(function(e){return{id:e}})}},ids:{type:"array",shortcode:function(e){var t=e.named.ids;return Ae(t)}},linkTo:{type:"string",shortcode:function(e){var t=e.named.link,n=void 0===t?"attachment":t;return"file"===n?"media":n}}}},{type:"files",isMatch:function(e){return 1!==e.length&&de(e,function(e){return 0===e.type.indexOf("image/")})},transform:function(e,t){var n=he("occ/slider",{images:e.map(function(e){return se({url:Ee(e)})})});return ke({filesList:e,onFileChange:function(e){var r=e.map(se);t(n.clientId,{ids:fe(r,"id"),images:r})},allowedTypes:["image"]}),n}}],to:[{type:"block",blocks:["core/image"],transform:function(e){var t=e.images;return t.length>0?t.map(function(e){var t=e.id,n=e.url,r=e.alt,o=e.caption;return he("core/image",{id:t,url:n,alt:r,caption:o})}):he("core/image")}}]},edit:ue,save:function(e){var t=e.attributes,n=t.images,r=t.imageCrop,o=t.autoplay,i=t.speed,a=t.effect,l=t.linkTo;return wp.element.createElement("ul",{className:"".concat(r?"is-cropped":""),"data-autoplay":o,"data-speed":i,"data-effect":a},n.map(function(e){var t;switch(l){case"media":t=e.url;break;case"attachment":t=e.link}var n=wp.element.createElement("img",{src:e.url,alt:e.alt,"data-id":e.id,"data-link":e.link,className:e.id?"wp-image-".concat(e.id):null});return wp.element.createElement("li",{key:e.id||e.url,className:"blocks-gallery-item"},wp.element.createElement("figure",null,t?wp.element.createElement("a",{href:t},n):n,e.caption&&e.caption.length>0&&wp.element.createElement(Se.Content,{tagName:"figcaption",value:e.caption})))}))}};ve(_e,Te)},function(e,t){},function(e,t){}]);
//# sourceMappingURL=block.build.js.map